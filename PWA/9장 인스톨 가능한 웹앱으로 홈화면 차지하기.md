# 9장 인스톨 가능한 웹앱으로 홈화면 차지하기

해당 기능을 구현 하기 위해선 간단한 3단계만 거치면 된다.

1. 서비스워커 등록하기
2. 웹 앱 매니페스트(manifest) 파일생성하기
3. 웹 앱에서 매니페스트에 링크 추가하기

서비스워커는 이미 있으므로 3분의 1은 성공했다. 

## 매니페스트(manifest)

매니페스트는 웹 앱이 어떻게 구동되고 작동하는지, 어떤 모양으로 보여지는 지 를 설명하는 간단한 JSON파일이다. 

우선 고담호텔 앱에 public에 manifest.json을 생성하고 아래의 코드를 추가하자 매니페스트의 구조는 이후에 자세히 다룰 예정이다.

```json
{
    "short_name": "Gotham Imperial",
    "name": "Gotham Imperial Hotel",
    "description": "Book your next stay, manage your reservations, and explore Gotham",
    "start_url": "/my-account?utm_source=pwa",
    "scope": "/",
    "display": "fullscreen",
    "icons": [
      {
        "src": "/img/app-icon-192.png",
        "type": "image/png",
        "sizes": "192x192"
      },
      {
        "src": "/img/app-icon-512.png",
        "type": "image/png",
        "sizes": "512x512"
      }
    ],
    "theme_color": "#242424",
    "background_color": "#242424"
  }
```

이제 아래의 HTML코드를 index.html과 my-account.html의 헤드에 추가합니다. 해당 태그를 이용하여 이사이트에 매니페스트 파일이 있음을 알립니다. 

```html
<link rel="manifest" href="/manifest.json">
```

이제 나머지는 브라우져의 몫이다.



## 브라우져가 **"앱설치 배너"**를 언제 표시할지 결정하는 방법

브라우져가 판당했을때 사이트가 홈스크린에 설치되기가 적합하고 사용자가 해당사이트에 관심이 생긴것으로 판단되면 웹앱 설치 배너가 나타날 것이다.  해당 조건은 아래와 같습니다.

1. 사이트가 HTTPS를 통해 제공된다.
2. 등록된 서비스 워커가 있다.
3. 이 사이트는 최소 4가지 필수 필드를 포함하는 웹 앱 매니페스트를 가진다.

브라우저는 사용자가 홈 화면에 바로가기를 두고 싶을 만큼의 웹 앱에 대한 관심을 가졌을 때만 웹앱 철치 배너를 띄운다. 브라우저가 이를 판단하는 **휴리스틱(경험적 반복론)**은 브라우저에따라 다르다 

위의 조건을 아래와같이 수도코드를 이용하여 표현 할 수 있다.

```pseudocode
if (
	웹앱이 HTTPS로 제공됨 &&
	등록된 서비스워커가 있음 &&
	필수 속성을 포함하는 매니페스트 파일이 존재함 &&
	브라우져 차원에서 사용자가 해당 웹 앱이 지속적인 관심을 갖을것이라 판단함 &&
	등일 웹 앱에 대해 사용자가 웹 앱 성치배너를 거부한 적이 없음
) then {
	웹 앱 설치 배너가 표시됨
}
```



## 웹 앱 매니 페스트의 구조

웹 앱 매니페스트 포멧에 대해 살펴보자

유효한 JSON파일은 메니페스트 파일이 될 수 있지만 **웹 앱 설치 배너를 트리거 하려면** 매니페스트 파일에는 **반드시 다음 속성이 포함**되어야한다. 



### -웹 앱 설치배너를 위한 최소 속성들 

#### name 또는 short_name

매니페스트 이름에는 name 이나 short_name 둘 중 하나가 포함 되어야 한다. 하지만 가급적이면 두기지가 모두포함되어있는것이 좋다.

name은 앱의 전체 이름이다. 앱설치 배너 그리고 앱의 런치 스크린 내에 긴이름을 표시할 수 있을때 사용된다.

만약 앱이름이 특별히 긴 경우 short_name은 전체 이름을 표시할 수 없을 때 대안을 제공한다. 



#### start_url

**아이콘을 클릭하면 열리는 URL**이다. 고담어플에서는  **"start_url": "/my-account?utm_source=pwa",**와 같이 사용하는데 이때 URL에 utm_source=pwa 태그를 쿼리스트링에 추가하는디 이 태그는 애널리틱스 소프트웨어가 방문자를 별도로 추적할 떄 사용한다. 



#### icons

하나이상의 객체를 포함하는 배열로서 웹 앱이 사용할 수 있는 아이콘을 나타낸다. 각 객체는 다음과 같은 속성을 포함한다.

* src : 이미지의 대한 상대/절대 위치
* type : 파일의 유형
* size : 이미지의 픽셀 디멘션

참고로 웹앱 트리거가 실행되려면 매니페스트가 최소 **144픽셀 X 144픽셀 이상**의 아이콘을 하나이상 포함해야한다.

각각의 기기에서 현재 자신의 기기에서 가장 알맞는 사이즈의 아이콘을 가져온다. 따라서 대부분의 기기에서 사용할 수 있도록 **최소한 192픽셀 X 192픽셀 크기의 아이콘 하나와 512픽셀 X 512픽셀크기의 아이콘 하나**가 필요하다.



#### display

**앱이 실행될 디스플레이 모드를 제어**한다. 가능한 설정값은 아래와 같다. 

* browser : 브라우저에서 앱을 연다.
* standalone : 주소창 같은 브라우져의 사용자 인페이스 없이 앱을 연다.
* fullscreen : 브라우저와 디바이스의 UI 없이 앱을 연다.

웹 앱설치 배너가 나타나려면 display속성은 fullscreen 혹은 standalone으로 설정되어야 한다.



### 그 외 다양한 매니페스트 속성들 

#### description

앱에 대한 설명 

#### orientation

화면 방향을 설정할 수 있다. 앱의 레이아웃이 세로 혹은 가로 둘중 하나에 적합한 경우에 유용하다.

화면 방향에 대한 일반적인 설정은 아래와 같습니다.

* landscape(경치) : 가로
* portrait(초상화) : 세로
* auto : 자동

#### theme_color



